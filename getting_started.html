

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting started &mdash; PyStack3D 2025.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />

  
      <script src="_static/jquery.js"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
      <script src="_static/doctools.js"></script>
      <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Parameters settings" href="params.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyStack3D
              <img src="_static/logo_black.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#project-directory-organization">Project directory organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#workflow-initialization">Workflow initialization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#case-of-a-zeiss-fib-sem">Case of a Zeiss FIB-SEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#workflow-execution">Workflow execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Single .tif file processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#outputs">Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="params.html">Parameters settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_notes.html">Developers Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">pystack3d</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyStack3D</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting started</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/getting_started.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading"></a></h1>
<p><strong>PyStack3D</strong> was originally designed to process hundreds or even thousands of .tif files forming a 3D stack, stored according to a specific folder structure (see below).
Since version <strong>2025.1</strong>, it is also possible to process a single (large) multi-frame .tif file. Refer to the section <a class="reference external" href="https://cea-metrocarac.github.io/pystack3d/getting_started.html#id1">Single .tif file processing</a> for more details.</p>
<section id="project-directory-organization">
<h2>Project directory organization<a class="headerlink" href="#project-directory-organization" title="Permalink to this heading"></a></h2>
<p>To be executed, a <strong>PyStack3D</strong> workflow requires both:</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">params.toml</span></code> file defining all the process steps parameters (see the <a class="reference external" href="https://cea-metrocarac.github.io/pystack3d/params.html">parameters settings</a> section)</p></li>
<li><p>a <strong>project directory</strong> including the <code class="docutils literal notranslate"><span class="pre">.tif</span></code> images named with their respective <strong>slice numbers</strong> and their <strong>z-positions</strong> either in the root directory:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project_dir</span>
    <span class="o">|--</span> <span class="n">params</span><span class="o">.</span><span class="n">toml</span>
    <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>   <span class="o">...</span>
</pre></div>
</div>
<p>or in sub-folders for a multi-channels acquisition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project_dir</span>
    <span class="o">|--</span> <span class="n">params</span><span class="o">.</span><span class="n">toml</span>
    <span class="o">|--</span> <span class="n">channel_1</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>           <span class="o">...</span>
    <span class="o">|--</span> <span class="n">channel_2</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>           <span class="o">...</span>
</pre></div>
</div>
<p>Once executed, the <strong>outputs</strong> directories related to each process step can be found inside the <code class="docutils literal notranslate"><span class="pre">process</span></code> directory as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project_dir</span>
    <span class="o">|--</span> <span class="n">params</span><span class="o">.</span><span class="n">toml</span>
    <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>   <span class="o">...</span>
    <span class="o">|--</span> <span class="n">process</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">cropping</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">outputs</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>           <span class="o">...</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">bkg_removal</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">outputs</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>           <span class="o">...</span>
    <span class="o">|</span>        <span class="o">...</span>
</pre></div>
</div>
<p>or for a multi-channels acquisition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">project_dir</span>
    <span class="o">|--</span> <span class="n">params</span><span class="o">.</span><span class="n">toml</span>
    <span class="o">|--</span> <span class="n">channel_1</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>           <span class="o">...</span>
    <span class="o">|--</span> <span class="n">channel_2</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>           <span class="o">...</span>
    <span class="o">|--</span> <span class="n">process</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">cropping</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">outputs</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">channel_1</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>   <span class="o">...</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">channel_2</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>   <span class="o">...</span>
    <span class="o">|</span>       <span class="o">|--</span> <span class="n">bkg_removal</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">outputs</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">channel_1</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>   <span class="o">...</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">channel_2</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0000_z</span><span class="o">=</span><span class="mf">0.0000</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|--</span> <span class="n">slice_0001_z</span><span class="o">=</span><span class="mf">0.0100</span><span class="n">um</span><span class="o">.</span><span class="n">tif</span>
    <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>       <span class="o">|</span>   <span class="o">...</span>
    <span class="o">|</span>        <span class="o">...</span>
</pre></div>
</div>
<p><em>(The content of each ‘outputs’ directory is detailed below)</em></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As illustrated above, following each process, images of the entire processed stack are saved. Consequently, this requires having a sufficient amount of free disk space.</p>
<p>For instance, in the case of a stack of 2000 images sized 2000x2000 encoded in 16 bits, each process step will require storing approximately 15GB of data.</p>
<p>To facilitate the cleaning of these large volumes of data, a <code class="docutils literal notranslate"><span class="pre">cleanup()</span></code> function was created (see the <strong>Workflow execution</strong> section below).</p>
</div>
</section>
<section id="workflow-initialization">
<h2>Workflow initialization<a class="headerlink" href="#workflow-initialization" title="Permalink to this heading"></a></h2>
<p>All the workflow instructions are provided in a <code class="docutils literal notranslate"><span class="pre">params.toml</span></code>.</p>
<p>A <strong>raw</strong> <code class="docutils literal notranslate"><span class="pre">params.toml</span></code> is given <a class="reference external" href="https://github.com/CEA-MetroCarac/pystack3d/blob/main/assets/toml/params.toml">here</a> (to be adapted according to needs).</p>
<section id="case-of-a-zeiss-fib-sem">
<h3>Case of a Zeiss FIB-SEM<a class="headerlink" href="#case-of-a-zeiss-fib-sem" title="Permalink to this heading"></a></h3>
<p>In the case of <strong>Zeiss</strong> FIB-SEM acquisitions, some <strong>metadata</strong> produced by the software for 3D acquisition (Atlas, developped by Fibics) can be automatically extracted from the .tif image files and the <code class="docutils literal notranslate"><span class="pre">Atlas3D.a3d-setup</span></code> file. Based on these, the default parameters for the processing can be adapted as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pystack3d.utils_metadata_fibics</span><span class="w"> </span><span class="kn">import</span> <span class="n">params_from_metadata</span>

<span class="n">params_from_metadata</span><span class="p">(</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">project_dir</span></code> refers to the project directory pathname containing the <code class="docutils literal notranslate"><span class="pre">Atlas3D.a3d-setup</span></code> file (mandatory file), and the .tif files in sub-directories corresponding to different channels (at least one slice in the first channel directory is required).
This will save a <code class="docutils literal notranslate"><span class="pre">params_from_metadata.toml</span></code> file based on the <strong>raw</strong> one but adapting some of the parameters to the acquisiton with the help of the extracted metadata.
The affected parameters are listed here:</p>
<ul class="simple">
<li><p>Name of the <strong>channels</strong> is read in the <code class="docutils literal notranslate"><span class="pre">Atlas3D.a3d-setup</span></code> file.</p></li>
<li><p>For the cropping step, <strong>area</strong> is defined based on the ROI of the first slice and will not take into account changes of ROI that might have been made during the acquisition.</p></li>
<li><p>For the resampling step, <strong>dz</strong> is read in the <code class="docutils literal notranslate"><span class="pre">Atlas3D.a3d-setup</span></code> file</p></li>
</ul>
<p>On top of that, the function checks that the first slice is square and that the field of view of the <code class="docutils literal notranslate"><span class="pre">Atlas3D.a3d-setup</span></code> file corresponds to the first slice size.</p>
<p>By default, the reference <code class="docutils literal notranslate"><span class="pre">params.toml</span></code> file used by <code class="code docutils literal notranslate"><span class="pre">params_from_metadata</span></code> for all the other parameters is the <strong>raw</strong> one. But the user can provide another reference .toml file through the <code class="docutils literal notranslate"><span class="pre">fname_toml_ref</span></code> argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">params_from_metadata</span><span class="p">(</span><span class="n">project_dir</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fname_toml_ref</span><span class="o">=</span><span class="n">my_toml_ref</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="workflow-execution">
<h2>Workflow execution<a class="headerlink" href="#workflow-execution" title="Permalink to this heading"></a></h2>
<p>A <strong>PyStack3D</strong> workflow execution is obtained with the following instructions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pystack3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Stack3d</span>

<span class="n">stack</span> <span class="o">=</span> <span class="n">Stack3d</span><span class="p">(</span><span class="n">input_name</span><span class="p">)</span>
<span class="n">stack</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">process_steps</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">input_name</span></code> corresponds either to the <strong>project directory pathname</strong> or to the <code class="docutils literal notranslate"><span class="pre">params.toml</span></code> in which the project directory pathname has to be defined via the <code class="docutils literal notranslate"><span class="pre">input_dirname</span></code> parameter.</p>
<p><code class="docutils literal notranslate"><span class="pre">process_steps</span></code> refers either to a single process step or to a list of process steps or can be omitted leading to the execution of the full process steps defined in the <code class="docutils literal notranslate"><span class="pre">params.toml</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># execute only the &#39;cropping&#39; process step</span>
<span class="n">stack</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">process_steps</span><span class="o">=</span><span class="s2">&quot;cropping&quot;</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># execute the &#39;cropping&#39; and the &#39;background removal&#39; process steps</span>
<span class="n">stack</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">process_steps</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cropping&quot;</span><span class="p">,</span> <span class="s2">&quot;bkg_removal&quot;</span><span class="p">],</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># execute all the process steps defined in the &#39;params.toml&#39; file</span>
<span class="n">stack</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">nproc</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">nproc</span></code> corresponds to the number of threads to use for the workflow execution.</p>
<p>Note that an additional boolean keyword named <code class="docutils literal notranslate"><span class="pre">serial</span></code> allows to realize non-serialized calculations when setting to <code class="docutils literal notranslate"><span class="pre">False</span></code> (said differently, with <code class="docutils literal notranslate"><span class="pre">serial</span> <span class="pre">=</span> <span class="pre">False</span></code> the workflow is executed using the original raw input data for each process step).</p>
<p>At the end of a workflow execution, a cleaning up of all the .tif files (except the ones related to the last <code class="docutils literal notranslate"><span class="pre">process_steps</span></code>) can be done easily as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stack</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
</pre></div>
</div>
<p>At least, to ease the full 3D-stack visualization, .tif files can be concatenated in a single one. See <code class="xref py py-class docutils literal notranslate"><span class="pre">concatenate_tif</span></code> for more details:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stack</span><span class="o">.</span><span class="n">concatenate_tif</span><span class="p">()</span> <span class="c1"># tif files concatenation related to the last process_step</span>
<span class="n">stack</span><span class="o">.</span><span class="n">concatenate_tif</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">)</span> <span class="c1"># tif files concatenation related to the input data</span>
</pre></div>
</div>
</section>
<section id="id1">
<h2>Single .tif file processing<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h2>
<p>Processing a single large .tif file without using a .toml file is also supported.</p>
<p>Here is an example of a step-by-step registration processing on a single processor applied to a .tif file named <em>fname</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pystack3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Stack3d</span>

<span class="n">stack</span> <span class="o">=</span> <span class="n">Stack3d</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="n">stack</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;registration_calculation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;transformation&#39;</span><span class="p">:</span> <span class="s1">&#39;TRANSLATION&#39;</span><span class="p">,</span> <span class="s1">&#39;nb_blocks&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}</span>
<span class="n">stack</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">process_steps</span><span class="o">=</span><span class="s1">&#39;registration_calculation&#39;</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">stack</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;registration_transformation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;subpixel&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;cropping&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">stack</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">process_steps</span><span class="o">=</span><span class="s1">&#39;registration_transformation&#39;</span><span class="p">,</span> <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">stack</span><span class="o">.</span><span class="n">concatenate_tif</span><span class="p">(</span><span class="n">process_step</span><span class="o">=</span><span class="s1">&#39;registration_transformation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this heading"></a></h2>
<p>Each process steps returns <strong>specific</strong> and <strong>standard</strong> outputs (data and figures) in the related process step <strong>outputs</strong> directory.</p>
<p><strong>Specific</strong> outputs are related to each process steps. They are described in each of the process steps sections hereafter (if existing).</p>
<p><strong>Standard</strong> outputs consist in the statistics (min, max, mean) on gray values evolution along the stack axis (z-axis, by convention) <strong>before</strong> and <strong>after</strong> the process step execution. For the ‘after’ values, the statistics without and with data reformatting compatible with the input data format are plotted. Indeed, some process steps may modify the data type (typically from integer to float) and/or generate data outside the range of authorized data values. <em>(This could happen for instance in the</em> <strong>bkg_removal</strong> <em>process step when subtracting the background that could generate negative or positive overflowed values)</em>.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="_images/bkg_removal_stats.png"><img alt="_images/bkg_removal_stats.png" src="_images/bkg_removal_stats.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-text">Example of statistics returned by the <strong>bkg_removal</strong> process step in the <a class="reference external" href="https://github.com/CEA-MetroCarac/pystack3d/blob/main/examples/ex_synthetic_stack.py">synthetic test case</a>.</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<p>Two examples are provided with the pystack3d package github repository.</p>
<p>The first one corresponds to a synthetic stack composed of small images. It aims at providing quick overviews of the process steps outcomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">pystack3d</span>
<span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">ex_synthetic_stack</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The second one is based on a real but reduced stack (8 slices) issued from a FIB-SEM images acquisition. Although reduced, its execution is longer than the previous one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">examples</span><span class="o">/</span><span class="n">ex_real_stack</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="params.html" class="btn btn-neutral float-right" title="Parameters settings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2025, The PyStack3D development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>